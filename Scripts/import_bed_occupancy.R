#install.packages("readxl")
library("readxl")

headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q4-2021-22-Final-OIUJK.xlsx", n_max=1, skip=14, col_names=FALSE))
q42122 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q4-2021-22-Final-OIUJK.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q3-2021-22-Final.xlsx", n_max=1, skip=14, col_names=FALSE))
q32122 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q3-2021-22-Final.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q2-2021-22-Final.xlsx", n_max=1, skip=14, col_names=FALSE))
q22122 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q2-2021-22-Final.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q1-2021-22-Final.xlsx", n_max=1, skip=14, col_names=FALSE))
q12122 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q1-2021-22-Final.xlsx", skip=17, col_names=headers)

#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q4-2020-21-Final-1.xlsx", n_max=1, skip=14, col_names=FALSE))
q42021 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q4-2020-21-Final-1.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q3-2020-21-Final-1.xlsx", n_max=1, skip=14, col_names=FALSE))
q32021 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q3-2020-21-Final-1.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q2-2020-21-Final-1.xlsx", n_max=1, skip=14, col_names=FALSE))
q22021 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q2-2020-21-Final-1.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q1-2020-21-Final-1.xlsx", n_max=1, skip=14, col_names=FALSE))
q12021 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q1-2020-21-Final-1.xlsx", skip=17, col_names=headers)

#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Q4-1920-Web_File-Final-DE5WC.xlsx", n_max=1, skip=14, col_names=FALSE))
q41920 <- read_excel("ambulance/Beds-Open-Overnight-Q4-1920-Web_File-Final-DE5WC.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Q4-1920-Web_File-Final-DE5WC.xlsx", n_max=1, skip=14, col_names=FALSE))
q31920 <- read_excel("ambulance/Beds-Open-Overnight-Q3-1920-Web_File-Final-DE5WC.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Q4-1920-Web_File-Final-DE5WC.xlsx", n_max=1, skip=14, col_names=FALSE))
q21920 <- read_excel("ambulance/Beds-Open-Overnight-Q2-1920-Web_File-Final-DE5WC.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Q4-1920-Web_File-Final-DE5WC.xlsx", n_max=1, skip=14, col_names=FALSE))
q11920 <- read_excel("ambulance/Beds-Open-Overnight-Q1-1920-Web_File-Final-DE5WC.xlsx", skip=17, col_names=headers)

#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Final_Q4_2018-19.xlsx", n_max=1, skip=14, col_names=FALSE))
q41819 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Final_Q4_2018-19.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Final-Q3-201819.xlsx", n_max=1, skip=14, col_names=FALSE))
q31819 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Final-Q3-201819.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Q2-201819-REVISED-Web_File-Final.xlsx", n_max=1, skip=14, col_names=FALSE))
q21819 <- read_excel("ambulance/Beds-Open-Overnight-Q2-201819-REVISED-Web_File-Final.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Q1-201819-REVISED-Web_File-Final.xlsx", n_max=1, skip=14, col_names=FALSE))
q11819 <- read_excel("ambulance/Beds-Open-Overnight-Q1-201819-REVISED-Web_File-Final.xlsx", skip=17, col_names=headers)

#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Q4-201718-REVISED-Web_File-Final.xlsx", n_max=1, skip=14, col_names=FALSE))
q41718 <- read_excel("ambulance/Beds-Open-Overnight-Q4-201718-REVISED-Web_File-Final.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Q4-201718-REVISED-Web_File-Final.xlsx", n_max=1, skip=14, col_names=FALSE))
q31718 <- read_excel("ambulance/Beds-Open-Overnight-Q3-201718-REVISED-Web_File-Final.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q2-2017-18-Final.xlsx", n_max=1, skip=14, col_names=FALSE))
q21718 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q2-2017-18-Final.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q1-2017-18-Final.xlsx", n_max=1, skip=14, col_names=FALSE))
q11718 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q1-2017-18-Final.xlsx", skip=17, col_names=headers)

#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q4-2016-17-Final-98123.xlsx", n_max=1, skip=14, col_names=FALSE))
q41617 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q4-2016-17-Final-98123.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q3-2016-17-Final-98123.xlsx", n_max=1, skip=14, col_names=FALSE))
q31617 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q3-2016-17-Final-98123.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q2-2016-17-Final-98123.xlsx", n_max=1, skip=14, col_names=FALSE))
q21617 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q2-2016-17-Final-98123.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q1-2016-17-Final-98123.xlsx", n_max=1, skip=14, col_names=FALSE))
q11617 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q1-2016-17-Final-98123.xlsx", skip=17, col_names=headers)

#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q4-2015-16-Revised-Aug16-Final-84398.xlsx", n_max=1, skip=14, col_names=FALSE))
q41516 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q4-2015-16-Revised-Aug16-Final-84398.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Final-Q3-2015-16-39849.xlsx", n_max=1, skip=14, col_names=FALSE))
q31516 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Final-Q3-2015-16-39849.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Final-Q2-2015-16-38498.xlsx", n_max=1, skip=14, col_names=FALSE))
q21516 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Final-Q2-2015-16-38498.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Final-Q1-2015-16-52341.xlsx", n_max=1, skip=14, col_names=FALSE))
q11516 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Final-Q1-2015-16-52341.xlsx", skip=17, col_names=headers)

#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q4-2014-15-Revised-Nov15-Final-41885.xlsx", n_max=1, skip=14, col_names=FALSE))
q41415 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q4-2014-15-Revised-Nov15-Final-41885.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q3-2014-15-Revised-Nov15-Final-33314.xlsx", n_max=1, skip=14, col_names=FALSE))
q31415 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q3-2014-15-Revised-Nov15-Final-33314.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q2-2014-15-Revised-Nov15-Final-41447.xlsx", n_max=1, skip=14, col_names=FALSE))
q21415 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q2-2014-15-Revised-Nov15-Final-41447.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q1-2014-15-Revised-Nov15-Final-21447.xlsx", n_max=1, skip=14, col_names=FALSE))
q11415 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q1-2014-15-Revised-Nov15-Final-21447.xlsx", skip=17, col_names=headers)

#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q4-2013-14-Final-Working-Revised-33335.xlsx", n_max=1, skip=14, col_names=FALSE))
q41314 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q4-2013-14-Final-Working-Revised-33335.xlsx", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q3-2013-14-Revised-Final1.xls", n_max=1, skip=14, col_names=FALSE))
q31314 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q3-2013-14-Revised-Final1.xls", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q2-2013-14-Revised-Final1.xls", n_max=1, skip=14, col_names=FALSE))
q21314 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q2-2013-14-Revised-Final1.xls", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q1-2013-14-Nov-Revised-Revised-Final.xls", n_max=1, skip=14, col_names=FALSE))
q11314 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q1-2013-14-Nov-Revised-Revised-Final.xls", skip=17, col_names=headers)

#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q4-2012-13-Revised-Final-79659.xls", n_max=1, skip=14, col_names=FALSE))
q41213 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q4-2012-13-Revised-Final-79659.xls", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q3-2012-13-Revised-Final-76557.xls", n_max=1, skip=14, col_names=FALSE))
q31213 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q3-2012-13-Revised-Final-76557.xls", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q4-2012-13-Revised-Final-79659.xls", n_max=1, skip=14, col_names=FALSE))
q21213 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q2-2012-13-May-2013-Refresh-Final-8947-v2.xls", skip=17, col_names=headers)
#headers <- as.character(read_excel("ambulance/Beds-Open-Overnight-Web_File-Q1-2012-13-May-2013-Refresh-Final-47384.xls", n_max=1, skip=14, col_names=FALSE))
q11213 <- read_excel("ambulance/Beds-Open-Overnight-Web_File-Q1-2012-13-May-2013-Refresh-Final-47384.xls", skip=17, col_names=headers)

bedoccup <- rbind(q11213,q21213,q31213,q41213,q11314,q21314,q31314,q41314,q11415,q21415,q31415,q41415,
 q11516,q21516,q31516,q41516,q11617,q21617,q31617,q41617,q11718,q21718,q31718,q41718,q11819,q21819,q31819,q41819,q11920,q21920,
 q31920,q41920,q12021,q22021,q32021,q42021,q12122,q22122,q32122,q42122)

saveRDS(bedoccup, file="ambulance/bedoccup.rds")
